webpackJsonp([1],{270:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=a(3),o=r(s),n=a(68),d=r(n),u=a(92),c=r(u),i=a(144),l=r(i);a(145);var p=a(251),f=r(p),y=a(69),g=a(146),x=a(142);t.default={namespace:"prodEdit",state:{editorState:"",goodsCategorys:[],tagKeys:[0]},subscriptions:{setup:function(e){var t=e.dispatch;e.history.listen(function(e){var a=e.pathname;if(a.indexOf("prod")>-1){t({type:"queryCategory"});var r=(0,f.default)("/prod/:type/:id?").exec(a),s=r&&r.length>1?r[1]:"",o=r&&r.length>2?r[2]:"";t("update"===s?{type:"queryGoods",payload:{id:o}}:{type:"setState",payload:{info:{},editorState:"",tagKeys:[0]}})}})}},effects:{queryCategory:c.default.mark(function e(t,a){var r,s,o,n=(t.payload,a.select),d=a.call,u=a.put;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:if(r=e.sent.app,!(r.goodsCategorys.length>0)){e.next=8;break}return e.next=6,u({type:"setState",payload:{goodsCategorys:r.goodsCategorys}});case 6:e.next=24;break;case 8:return e.next=10,d(g.goodsCategorys);case 10:if(s=e.sent,!(o=s.data)){e.next=23;break}if("0000"!=o.head.code){e.next=20;break}return e.next=16,u({type:"app/setState",payload:{goodsCategorys:o.body.goodsCategorys}});case 16:return e.next=18,u({type:"setState",payload:{goodsCategorys:o.body.goodsCategorys}});case 18:e.next=21;break;case 20:(0,x.ajaxFail)(o);case 21:e.next=24;break;case 23:l.default.error("\u7f51\u7edc\u5f02\u5e38");case 24:case"end":return e.stop()}},e,this)}),queryGoods:c.default.mark(function e(t,a){var r,s,o,n,u,i=t.payload,p=(a.select,a.call),f=a.put;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(g.getGoodsById,{goodsId:i.id});case 2:if(r=e.sent,!(s=r.data)){e.next=21;break}if("0000"!=s.head.code){e.next=18;break}return o=void 0,n=[],u=(0,d.default)(s.info,[]),o=s.info.proDetail,s.info.tags?(u.tags=s.info.tags.split(","),u.tags.map(function(e,t){n.push(t)})):n.push(0),u.listImgUrl=[{uid:1,name:"xxx.png",status:"done",url:s.info.listImgUrl}],u.detailImgUrls=[],s.info.detailImgUrls.split(",").map(function(e,t){u.detailImgUrls.push({uid:t,name:"xxx.png",status:"done",url:e})}),e.next=16,f({type:"setState",payload:{info:u,editorState:o,tagKeys:n}});case 16:e.next=19;break;case 18:(0,x.ajaxFail)(s);case 19:e.next=22;break;case 21:l.default.error("\u7f51\u7edc\u5f02\u5e38");case 22:case"end":return e.stop()}},e,this)}),addGoods:c.default.mark(function e(t,a){var r,s,n=t.payload,d=(a.select,a.call),u=a.put;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(g.addGoods,(0,o.default)({},n.params));case 2:if(r=e.sent,!(s=r.data)){e.next=14;break}if("0000"!=s.head.code){e.next=11;break}return l.default.success(s.head.msg),e.next=9,u(y.routerRedux.push("/prod"));case 9:e.next=12;break;case 11:(0,x.ajaxFail)(s);case 12:e.next=15;break;case 14:l.default.error("\u7f51\u7edc\u5f02\u5e38");case 15:case"end":return e.stop()}},e,this)})},reducers:{setState:function(e,t){return(0,o.default)({},e,t.payload)}}},e.exports=t.default}});