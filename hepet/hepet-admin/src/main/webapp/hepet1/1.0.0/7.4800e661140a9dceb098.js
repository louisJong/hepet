webpackJsonp([7],{572:function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(92),o=s(r),n=a(144),d=s(n),c=a(3),u=s(c);a(145);var l=a(251),p=(s(l),a(146)),i=a(142);t.default={namespace:"prod",state:{selectParams:{goodsName:"",brandName:"",categoryCode:""},pageSize:10,currentPage:1,tableLoading:!0,goodsList:[],goodsCategorys:[]},subscriptions:{setup:function(e){var t=e.dispatch;e.history.listen(function(e){"/prod"===e.pathname&&(t({type:"query"}),t({type:"queryCategory"}))})}},effects:{query:o.default.mark(function e(t,a){var s,r,n,c,l,g=t.payload,y=a.select,f=a.call,x=a.put;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return s=e.sent.prod,r=g?g.selectParams:s.selectParams,e.next=6,x({type:"setState",payload:{tableLoading:!0}});case 6:return e.next=8,f(p.goodsList,(0,u.default)({},r,{pageIndex:s.currentPage-1,limit:s.pageSize}));case 8:return n=e.sent,c=n.data,e.next=12,x({type:"setState",payload:{tableLoading:!1}});case 12:if(!c){e.next=23;break}if("0000"!=c.head.code){e.next=20;break}return l=c.body.goodsList||[],l.map(function(e,t){e.loading=!1,e.index=t}),e.next=18,x({type:"setState",payload:{selectParams:r,goodsList:l,total:c.body.count||0}});case 18:e.next=21;break;case 20:(0,i.ajaxFail)(c);case 21:e.next=24;break;case 23:d.default.error("\u7f51\u7edc\u5f02\u5e38");case 24:case"end":return e.stop()}},e,this)}),changeGoodsStatus:o.default.mark(function e(t,a){var s,r,n,c,u,l=t.payload,g=a.select,y=a.call,f=a.put;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return s=e.sent.prod,r=s.goodsList,r[l.currIndex].loading=!0,e.next=7,f({type:"setState",payload:{goodsList:r}});case 7:return e.next=9,y(p.goodsPutSoldOrOff,{goodsId:l.goodsId,status:l.status});case 9:if(n=e.sent,!(c=n.data)){e.next=25;break}if("0000"!=c.head.code){e.next=18;break}return d.default.success(c.head.msg),e.next=16,f({type:"query"});case 16:e.next=23;break;case 18:return u=s.goodsList,u[l.currIndex].loading=!1,e.next=22,f({type:"setState",payload:{goodsList:u}});case 22:(0,i.ajaxFail)(c);case 23:e.next=26;break;case 25:d.default.error("\u7f51\u7edc\u5f02\u5e38");case 26:case"end":return e.stop()}},e,this)}),queryCategory:o.default.mark(function e(t,a){var s,r,n,c=(t.payload,a.select),u=a.call,l=a.put;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:if(s=e.sent.app,!(s.goodsCategorys.length>0)){e.next=8;break}return e.next=6,l({type:"setState",payload:{goodsCategorys:s.goodsCategorys}});case 6:e.next=24;break;case 8:return e.next=10,u(p.goodsCategorys);case 10:if(r=e.sent,!(n=r.data)){e.next=23;break}if("0000"!=n.head.code){e.next=20;break}return e.next=16,l({type:"app/setState",payload:{goodsCategorys:n.body.goodsCategorys}});case 16:return e.next=18,l({type:"setState",payload:{goodsCategorys:n.body.goodsCategorys}});case 18:e.next=21;break;case 20:(0,i.ajaxFail)(n);case 21:e.next=24;break;case 23:d.default.error("\u7f51\u7edc\u5f02\u5e38");case 24:case"end":return e.stop()}},e,this)})},reducers:{setState:function(e,t){return(0,u.default)({},e,t.payload)}}},e.exports=t.default}});